# Androidå¼€æºæ¡†æ¶å®è·µæŒ‡å—ï¼šRxJava

**å…³äºä½œè€…**

>éƒ­å­æ˜Ÿï¼Œç¨‹åºå‘˜ï¼Œå‰ä»–æ‰‹ï¼Œä¸»è¦ä»äº‹Androidå¹³å°åŸºç¡€æ¶æ„æ–¹é¢çš„å·¥ä½œï¼Œæ¬¢è¿äº¤æµæŠ€æœ¯æ–¹é¢çš„é—®é¢˜ï¼Œå¯ä»¥å»æˆ‘çš„[Github](https://github.com/guoxiaoxing)æissueæˆ–è€…å‘é‚®ä»¶è‡³guoxiaoxingse@163.comä¸æˆ‘äº¤æµã€‚

**æ–‡ç« ç›®å½•**

- ä¸€ äº‹ä»¶æ¨¡å‹
- äºŒ æ“ä½œç¬¦
- ä¸‰ çº¿ç¨‹è°ƒåº¦
- å›› åº”ç”¨åœºæ™¯

>A library for composing asynchronous and event-based programs using observable sequences for the Java VM.

è¦æ›´æ·±å…¥çš„ç†è§£RxJava/RxAndriodçš„å®è·µåŸç†ï¼Œæˆ‘ä»¬å°±è¦å…ˆç†è§£ReactiveXç›¸å…³åŸºç¡€ç†è®ºã€‚

>ReactiveXæ˜¯Reactive Extensionsçš„ç¼©å†™ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯ä»¥ä½¿ç”¨å¯è§‚å¯Ÿçš„æ•°æ®æµè¿›è¡Œå¼‚æ­¥ç¼–ç¨‹çš„ç¼–ç¨‹æ¥å£ï¼Œå®ƒç»“åˆäº†è§‚å¯Ÿè€…æ¨¡å¼ï¼Œè¿­ä»£å™¨æ¨¡å¼ä¸å‡½æ•°å¼ç¼–ç¨‹çš„ç²¾åã€‚

-[ReactiveXå®˜æ–¹ç½‘ç«™](http://reactivex.io/)

è¯´åˆ°ReactiveXæˆ‘ä»¬ä¸å¾—ä¸æä¸€ä¸‹å‡½æ•°å¼ç¼–ç¨‹ï¼ŒReactiveXå°±æ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„ä¸€ç§è‰¯å¥½å®è·µã€‚

>å‡½æ•°å¼ç¼–ç¨‹åŒå‘½ä»¤å¼ç¼–ç¨‹ï¼Œé¢å‘å¯¹è±¡ç¼–ç¨‹ä¸€æ ·ï¼Œä¹Ÿæ˜¯ç¼–ç¨‹èŒƒå¼çš„ä¸€ç§ï¼Œè¯´çš„æ˜¯ä¸€ç§ç¼–ç¨‹æ–¹æ³•ï¼Œå°†å‡½æ•°è§†ä¸ºä¸€ç­‰å…¬æ°‘ï¼Œå°†æ‰€æœ‰è®¡ç®—éƒ½æè¿°ä¸ºä¸€ç§è¡¨è¾¾å¼
æ±‚å€¼ï¼Œå‡½æ•°å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹å®šä¹‰å’Œè°ƒç”¨ï¼Œå°±åƒæˆ‘ä»¬å®šä¹‰å˜é‡é‚£æ ·ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å¯¹å‡½æ•°è¿›è¡Œä»»æ„ç»„åˆã€‚

æ›´å¤šå…³äºå‡½æ•°å¼ç¼–ç¨‹çš„è®¨è®ºå¯ä»¥å‚è§ï¼š

- [å‡½æ•°å¼ç¼–ç¨‹åˆæ¢](http://www.ruanyifeng.com/blog/2012/04/functional_programming.html)
- [ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹æ€ç»´](https://www.zhihu.com/question/28292740)

ReactiveXçš„ä¼˜ç‚¹ï¼š

- æ‰©å±•äº†è§‚å¯Ÿè€…æ¨¡å¼ç”¨äºæ”¯æŒæ•°æ®ä¸äº‹ä»¶åºåˆ—ï¼Œæ·»åŠ äº†ä¸€äº›æ“ä½œç¬¦ç”¨äºç»„åˆå’Œæ“ä½œè¿™äº›åºåˆ—ï¼Œè€Œæ— éœ€å»å…³æ³¨åº•å±‚çš„æœºåˆ¶ï¼Œä¾‹å¦‚ï¼šçº¿ç¨‹ã€åŒæ­¥ã€çº¿ç¨‹å®‰å…¨ã€å¹¶å‘æ•°æ®ç»“æ„ä¸éé˜»å¡IOç­‰ã€‚
- å‡½æ•°å¼ç¼–ç¨‹é£æ ¼ï¼Œå¯¹å¯è§‚å¯Ÿæ•°æ®æµä½¿ç”¨æ— å‰¯ä½œç”¨çš„è¾“å…¥è¾“å‡ºå‡½æ•°ï¼Œé¿å…äº†ç¨‹åºé‡Œé”™ç»¼å¤æ‚çš„çŠ¶æ€ã€‚
- è§£å†³äº†å¤šå±‚å›è°ƒçš„ç—›ç‚¹ï¼Œæˆ‘ä»¬é€šå¸¸å¯¹äºå¼‚æ­¥çš„å®ç°å°±æ˜¯"æ¥å£+å›è°ƒ"çš„æ–¹å¼ï¼Œè¿™åœ¨å•å±‚å¼‚æ­¥é‡Œæ˜¯å¯ç”¨çš„ï¼Œä½†æ˜¯é¢å¯¹åµŒå¥—çš„å¼‚æ­¥ç»„åˆå°±æ˜¾å¾—ååˆ†ç¬¨æ‹™ã€‚ğŸ˜„

```
é‚£ä¸€å¤©äººä»¬åˆå›æƒ³èµ·äº†éƒ½å¤šå±‚å›è°ƒä¸è¿·ä¹‹ç¼©è¿›æ”¯é…çš„ææƒ§ã€‚â˜¹ï¸

```

## ä¸€ äº‹ä»¶æ¨¡å‹

RxJava2ä¾ç„¶ä»¥è§‚å¯Ÿè€…æ¨¡å¼ä¸ºåŸºæœ¬éª¨æ¶ï¼Œæœ‰ä¸¤ç§è§‚å¯Ÿè€…æ¨¡å¼ï¼š

- Observableï¼ˆè¢«è§‚å¯Ÿè€…ï¼‰/ Observerï¼ˆè§‚å¯Ÿè€…ï¼‰ï¼šä¸æ”¯æŒèƒŒå‹
- Flowableï¼ˆè¢«è§‚å¯Ÿè€…ï¼‰/ Subscriberï¼ˆè§‚å¯Ÿè€…ï¼‰ï¼šæ”¯æŒèƒŒå‹

>èƒŒå‹ï¼ˆBackpressureï¼‰æŒ‡çš„æ˜¯åœ¨å¼‚æ­¥åœº


## äºŒ æ“ä½œç¬¦

## ä¸‰ çº¿ç¨‹è°ƒåº¦


ä¸Šä¸€ç¯‡æˆ‘ä»¬è®²äº†æ“ä½œç¬¦çš„å˜æ¢ä¸ç»„åˆï¼Œè¿™ä¸€ç¯‡æˆ‘ä»¬æ¥è®²ä¸€ä¸‹çº¿ç¨‹è°ƒåº¦ï¼Œè¿˜æ˜¯å…ˆè´´ä¸€ä¸‹RxJavaçš„äº‹ä»¶æ¨¡å‹å›¾ã€‚

äº‹ä»¶çš„ä¸Šä¸‹æ¸¸å¹¶ä¸æ€»æ˜¯è¿è¡Œåœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­ï¼Œä¸€èˆ¬çš„ï¼Œæˆ‘ä»¬é€šå¸¸å¸Œæœ›åœ¨å­çº¿ç¨‹ä¸­å¤„ç†è´¹æ—¶æ“ä½œï¼Œåœ¨ä¸»çº¿ç¨‹ä¸­æ›´æ–°UIã€‚

é»˜è®¤æƒ…å†µä¸‹äº‹ä»¶ä¸Šæ¸¸åœ¨å“ªä¸ªçº¿ç¨‹ä¸­å‘é€äº‹ä»¶ï¼Œäº‹ä»¶ä¸‹æ¸¸å°±åœ¨å“ªä¸ªçº¿ç¨‹æ¥æ”¶äº‹ä»¶ã€‚

ä¾‹å¦‚ï¼š

```java
Observable.create(new ObservableOnSubscribe<Integer>() {
            @Override
            public void subscribe(ObservableEmitter<Integer> e) throws Exception {
                Log.d(TAG, "subscribe() - thread: " + Thread.currentThread().getName());
                e.onNext(1);
            }
        }).subscribe(new Observer<Integer>() {
            @Override
            public void onSubscribe(Disposable d) {
                Log.d(TAG, "onSubscribe() - thread: " + Thread.currentThread().getName());
            }

            @Override
            public void onNext(Integer integer) {
                Log.d(TAG, "onNext() - thread: " + Thread.currentThread().getName());
            }

            @Override
            public void onError(Throwable e) {
                Log.d(TAG, "onError() - thread: " + Thread.currentThread().getName());
            }

            @Override
            public void onComplete() {
                Log.d(TAG, "onComplete() - thread: " + Thread.currentThread().getName());
            }
        });
```

è¾“å‡ºæ‰“å°

<img src="https://github.com/guoxiaoxing/android-open-framwork-analysis/raw/master/art/rxjava/thread_normal.png"/>

å¯ä»¥çœ‹å‡ºå®ƒä»¬éƒ½å·¥ä½œåœ¨ä¸»çº¿ç¨‹ä¸­ã€‚

RxJavaå†…éƒ¨ä½¿ç”¨çº¿ç¨‹æ± æ¥ç»´æŠ¤çº¿ç¨‹ï¼Œæ‹¥æœ‰è¾ƒé«˜çš„æ•ˆç‡ã€‚

RxJavaæŒ‡å®šçº¿ç¨‹

- subscribeOn()ï¼šæŒ‡å®šObservableæ‰€åœ¨çº¿ç¨‹ã€‚
- observeOn()ï¼šæŒ‡å®šObserveræ‰€åœ¨çº¿ç¨‹ã€‚

RxJavaå†…ç½®çº¿ç¨‹æ¨¡å‹

- Schedulers.single()ï¼šè¿”å›ä¸€ä¸ªé»˜è®¤çš„ï¼Œå…±äº«çš„ï¼Œå•çº¿ç¨‹çš„Schedulerå®ä¾‹ï¼Œå®ƒé€šå¸¸ç”¨åœ¨é‚£äº›æœ‰è¾ƒå¼ºæ‰§è¡Œé¡ºåºè¦æ±‚çš„åå°çº¿ç¨‹ã€‚
- Schedulers.newThread()ï¼šè¿”å›ä¸€ä¸ªé»˜è®¤çš„ï¼Œå…±äº«çš„Schedulerå®ä¾‹ï¼Œå®ƒåˆ›å»ºä¸€ä¸ªå¸¸è§„çš„çº¿ç¨‹ã€‚
- Schedulers.trampoline()ï¼šè¿”å›ä¸€ä¸ªé»˜è®¤çš„ï¼Œå…±äº«çš„Schedulerå®ä¾‹ï¼Œå®ƒä»¥FIFOçš„æ–¹å¼æ¥æ‰§è¡Œä»»åŠ¡ã€‚
- Schedulers.io()ï¼šè¿”å›ä¸€ä¸ªé»˜è®¤çš„ï¼Œå…±äº«çš„Schedulerå®ä¾‹ï¼Œå®ƒä»£è¡¨IOæ“ä½œçš„çº¿ç¨‹ï¼Œé€šå¸¸ç”¨äºç½‘ç»œï¼Œè¯»å†™æ–‡ä»¶ç­‰IOå¯†é›†å‹æ“ä½œã€‚
- Schedulers.computation()ï¼šè¿”å›ä¸€ä¸ªé»˜è®¤çš„ï¼Œå…±äº«çš„Schedulerå®ä¾‹ï¼Œå®ƒé€šå¸¸ç”¨æ¥æ‰§è¡Œå¤æ‚çš„è®¡ç®—æ“ä½œã€‚
- AndroidSchedulers.mainThread()ï¼šAndroidä¸»çº¿ç¨‹


## å›› åº”ç”¨åœºæ™¯

## é™„å½•

- [Rxjavaå®˜æ–¹æ–‡æ¡£](http://reactivex.io/intro.html)
- [ReactiveXå®˜æ–¹ç½‘ç«™](http://reactivex.io/RxJava/2.x/javadoc/overview-summary.html)
- [ReactiveXå®˜æ–¹æ–‡æ¡£ä¸­æ–‡ç‰ˆ](https://mcxiaoke.gitbooks.io/rxdocs/content/Intro.html)